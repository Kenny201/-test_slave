
# Laravel 11 с Sail

Это проект на Laravel 11, настроенный для работы с Sail, Docker и WebSocket. В данном README описано, как поднять локальную среду с использованием Sail, а также как настроить и тестировать WebSocket с двумя очередями: `allRowsCreated` и `default`.

## Требования

Перед началом убедитесь, что у вас установлены следующие компоненты:

- Docker (с Docker Compose)
- PHP 8.1 или выше
- Composer
- Git

## Установка и настройка

### 1. Клонирование репозитория

```bash
git clone git@github.com:Kenny201/test_slave.git
cd laravel-sail-example
```

### 2. Установка зависимостей через Composer

Если у вас еще не установлен Composer, установите его. Затем выполните команду:

```bash
composer install
```

### 3. Настройка Sail

Laravel Sail — это официальный пакет Docker для разработки с Laravel. Он позволяет легко запустить приложение Laravel в Docker-контейнерах.

1. Для установки и настройки Sail выполните команду:

```bash
php artisan sail:install
```

2. Выберите настройки для вашего проекта, например, выбрать `MySQL` или `PostgreSQL` в качестве базы данных.

3. Запустите контейнеры с помощью следующей команды:

```bash
./vendor/bin/sail up
```

Эта команда поднимет все контейнеры (сервера, базы данных, очередь, Redis и другие сервисы), настроенные в Docker.

### 4. Доступ к приложению

После того как Sail запустит все контейнеры, вы сможете получить доступ к приложению через браузер по адресу:

```
http://localhost
```

Для использования других сервисов, таких как Redis или MySQL, используйте команды Sail:

- Для входа в контейнер с приложением (например, для запуска миграций):

```bash
./vendor/bin/sail shell
```

- Для запуска миграций:

```bash
./vendor/bin/sail artisan migrate
```

- Для просмотра логов:

```bash
./vendor/bin/sail logs
```

### 5. Запуск очередей для WebSocket

Для тестирования WebSocket, вам нужно запустить две очереди:

- `allRowsCreated`
- `default`

Чтобы запустить очереди, выполните следующие команды:

1. Для очереди `default`:

```bash
./vendor/bin/sail artisan queue:work
```

2. Для очереди `allRowsCreated`:

```bash
./vendor/bin/sail artisan queue:work --queue=allRowsCreated
```

Это позволит вам тестировать события WebSocket, которые публикуются в эти очереди.

### 6. Запуск тестов

Для запуска тестов убедитесь, что у вас все настроено правильно и выполните команду:

```bash
./vendor/bin/sail test
```

Это выполнит все тесты в вашем проекте и выведет результаты.

## Заключение

Теперь ваше приложение Laravel 11 настроено и работает с Sail и WebSocket. Вы можете тестировать различные очереди, обрабатывать события и взаимодействовать с приложением через Docker-контейнеры.
