
# Проект для загрузки и обработки файлов

## Описание

Этот проект позволяет загружать файлы формата Excel (xlsx), обрабатывать их и импортировать данные.

## Основной функционал

- **Загрузка файла**: Пользователь может загрузить файл Excel, который будет обработан и импортирован.
- **Обработка файла**: После загрузки файл обрабатывается в фоне с помощью очереди.
- **Уведомления**: После выполнения задачи импорта на странице `rows` появляется уведомление о количестве импортированных строк.

## Как это работает

1. Пользователь загружает файл через форму на странице загрузки.
2. После загрузки файл обрабатывается в фоне с помощью очереди.
3. Как только задача импорта завершена, на странице`rows`в правом нижнем углу появляется уведомление о количестве строк, которые были успешно импортированы.

## Страница Rows

На странице `rows` в правом нижнем углу выводится сообщение о количестве строк, которые были импортированы из загруженного файла. Это уведомление появляется после того, как задача импорта успешно завершена.

Пример уведомления:

```
Новые строки добавлены: 7588.
```

## Требования

Перед началом убедитесь, что у вас установлены следующие компоненты:

- Docker (с Docker Compose)
- PHP 8.1 или выше
- Composer
- Git

## Установка и настройка

### 1. Клонирование репозитория

```bash
git clone git@github.com:Kenny201/test_slave.git
cd laravel-sail-example
```

### 2. Установка зависимостей через Composer

Если у вас еще не установлен Composer, установите его. Затем выполните команду:

```bash
composer install
```

### 3. Настройка Sail

Laravel Sail — это официальный пакет Docker для разработки с Laravel. Он позволяет легко запустить приложение Laravel в Docker-контейнерах.

1. Для установки и настройки Sail выполните команду:

```bash
php artisan sail:install
```

2. Выберите настройки для вашего проекта, например, выбрать `MySQL` или `PostgreSQL` в качестве базы данных.

3. Запустите контейнеры с помощью следующей команды:

```bash
./vendor/bin/sail up
```

Эта команда поднимет все контейнеры (сервера, базы данных, очередь, Redis и другие сервисы), настроенные в Docker.

### 4. Доступ к приложению

После того как Sail запустит все контейнеры, вы сможете получить доступ к приложению через браузер по адресу:

```
http://localhost
```

Для использования других сервисов, таких как Redis или MySQL, используйте команды Sail:

- Для входа в контейнер с приложением (например, для запуска миграций):

```bash
./vendor/bin/sail shell
```

- Для запуска миграций:

```bash
./vendor/bin/sail artisan migrate
```

- Для просмотра логов:

```bash
./vendor/bin/sail logs
```

### 5. Запуск очередей для WebSocket

Для тестирования WebSocket, вам нужно запустить две очереди:

- `allRowsCreated`
- `default`

Чтобы запустить очереди, выполните следующие команды:

1. Для очереди `default`:

```bash
./vendor/bin/sail artisan queue:work
```

2. Для очереди `allRowsCreated`:

```bash
./vendor/bin/sail artisan queue:work --queue=allRowsCreated
```

Это позволит вам тестировать события WebSocket, которые публикуются в эти очереди.

### 6. Запуск тестов

Для запуска тестов убедитесь, что у вас все настроено правильно и выполните команду:

```bash
./vendor/bin/sail test
```

Это выполнит все тесты в вашем проекте и выведет результаты.

## Заключение

Теперь ваше приложение Laravel 11 настроено и работает с Sail и WebSocket. Вы можете тестировать различные очереди, обрабатывать события и взаимодействовать с приложением через Docker-контейнеры.
